# Context Saving Rules

## Purpose

コンテキストウィンドウは有限のリソースである。無駄な消費を避け、効率的に活用する。

## Rules

### 1. サブエージェントへの委任

調査・探索タスクはメインコンテキストで実行せず、サブエージェントに委任する。

- **コード検索・調査**: `researcher` エージェントまたは `Explore` サブエージェントに委任
- **計画立案**: `planner` エージェントに委任
- **コードレビュー**: `reviewer` エージェントに委任
- **デバッグ**: `debugger` エージェントに委任

### 2. Context7 MCP の活用

ライブラリやフレームワークのドキュメントを参照する際は、Context7 MCP を使用する。

- ドキュメントを直接コンテキストに貼り付けない
- `use context7` でプロンプトに最新ドキュメントを注入する
- 必要な部分だけを参照する

### 3. Memory MCP の活用

セッション間で持続すべき情報は Memory MCP に保存する。

保存すべき情報:
- アーキテクチャの重要な決定事項とその理由
- プロジェクト固有の規約・注意点
- 過去に遭遇した問題と解決策
- ユーザーの好み・スタイル

セッション開始時:
- Memory から過去のコンテキストを読み込む
- 前回のセッションで行った作業を把握する

### 4. 並列実行

独立したタスクは並列に実行して時間とコンテキストを節約する。

- 複数ファイルの読み込みは並列で行う
- 独立した調査は複数のサブエージェントで並列実行
- ビルド・テスト・リントなど独立したコマンドは並列実行

### 5. スコープ分割

大きなタスクは適切な粒度に分割する。

- 1つのサブエージェントに1つの責務
- 結果だけをメインコンテキストに返す
- 中間生成物はサブエージェント内で処理完了させる
